<% layout("layout") %>

<div class="d-flex justify-content-center mt-3">
    <h2><%= page %></h2>
</div>

<div class="d-flex justify-content-center mt-2">
    <div class="bg-light shadow-lg" id="client-messages-container">

    </div>
</div>

<div class="d-flex justify-content-center">
    <form method="POST" data-session-id="<%= session_id %>" id="client-message-form">
        <input type="text" placeholder="Message.." class="form-control d-inline w-75 shadow-sm" id="message-input">
        <button type="submit" class="btn btn-primary shadow-sm d-inline"><i class="fa fa-paper-plane"></i></button>                
    </form>
</div>

<div class="modal fade" id="client-init-modal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Please enter your information to continue</h5>
            </div>
            <form method="POST" autocomplete="off" id="client-init-form" class="shadow">
                <div class="modal-body">
                    <label class="form-label">Name</label>
                    <input type="text" class="form-control" name="name" autocomplete="off" required>

                    <br>
                    
                    <label class="form-label">Email</label>
                    <input type="email" class="form-control" name="email" autocomplete="off" required>

                    <br>

                    <label class="form-label">Phone</label>
                    <input type="text" class="form-control" name="phone">
                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-primary">Submit</button>
                </div>          
            </form>
        </div>
    </div>
</div>

<% if (!client_data) { %>
<script>
    let client_init_modal = new bootstrap.Modal(document.getElementById("client-init-modal"), {
        keyboard: false,
        backdrop: 'static'
    });

    client_init_modal.show();
</script>
<% } else { %>
<script>
    // document.getElementById("client-init-form").setAttribute("data-session-id", "999");

    let messages_container = document.getElementById("client-messages-container");
    message.new(messages_container, false, "Hello, <%= client_data.name %>. We will get back to you shortly!");
</script>

<script defer src="http://localhost:4000/socket.io/socket.io.js"></script>
<script defer src="scripts/chat.js"></script>
<% } %>